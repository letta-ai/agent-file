# Deep Research Agent (Deep Thought)
> ⚠️ **Warning:** You will need an `EXA_API_KEY` to run this agent. 

This is a deep research agent inspired by OpenAI's [Deep Research](https://openai.com/index/introducing-deep-research/). The agent repeatedly searches online sources using Exa's MCP server to write comprehensive research reports in response to user queries.

### Example Deep Research Report 
See an example report generated by the agent in response to the query "Why is pgvector not part of postgres?" in [`example_report.md`](./example_report.md). 

## Setup Instructions

### Option 1: Using the Agent Development Environment (ADE) - Recommended

1. **Import the agent file**: The `deep_research_agent.af` file can be imported directly into Letta. See the [documentation](https://docs.letta.com/guides/agents/agent-file#using-agent-file-with-letta) for import instructions.

2. **Set up the Exa MCP server**: 
   - Sign up at [exa.ai](https://exa.ai) and get an API key
   - In the Letta ADE, navigate to your agent
   - Click Tool Manager > Add MCP Server > Exa
   - Paste in your Exa API key

### Option 2: Using the Python Script

1. **Set up environment variables**: Create a `.env` file with:
   ```bash
   LETTA_API_KEY="sk-let-..."  # Get from app.letta.com
   EXA_API_KEY="..."           # Get from exa.ai
   LETTA_BASE_URL="http://localhost:8283"  # Optional, for self-hosted
   ```

2. **Install dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

3. **Run the script**:
   ```bash
   python deep_research_agent.py
   ```

## Tools 
The agent has access to the following tools:

### Custom Research Tools
- `create_research_plan`: Create a structured research plan for a given topic with specific steps
- `reset_research`: Clean up memory when starting a new research topic

### Exa MCP Tools
- `web_search_exa`: Search the web using Exa's semantic search
- `crawling_exa`: Extract and crawl content from web pages

### Memory Management Tools
- `memory_replace`: Update specific sections of memory blocks
- `memory_insert`: Add new information to memory blocks
- `memory_rethink`: Reorganize and optimize memory content

### Communication Tools
- `send_message`: Send updates to the user
- `conversation_search`: Search through conversation history

## Research State 
The agent uses core memory blocks to maintain research state across multiple search iterations:

- `persona`: The agent's personality and research approach (Deep Thought persona)
- `human`: Information about the user
- `research_plan`: The current research plan with progress tracking (uses markdown checkboxes)
- `research_report`: The final research report in markdown format

The agent is designed to be methodical, thorough, and persistent, continuing research until all planned steps are completed and a comprehensive report is generated.

## Agent Behavior

Deep Thought follows a systematic research process:

1. **Planning**: Creates a structured research plan with 3-4 key steps
2. **Research**: Uses Exa tools to search and crawl web sources
3. **Progress Tracking**: Updates the research_plan block with completed steps
4. **Report Writing**: Compiles findings into a comprehensive markdown report with citations
5. **Completion**: Stores the final report in the research_report memory block

The agent will continue researching until all planned steps are complete and will provide progress updates via send_message.
